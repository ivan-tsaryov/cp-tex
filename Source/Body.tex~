\chapter{МЕТОДЫ СЕЛЕКЦИИ РАДИОИМПУЛЬСОВ}
\section{Безыдентификационная псевдоградиентная адаптация}
gh

Суть псевдоградиентной процедуры применительно к~поставленной задаче в~следующем. На каждой итерации вычисляются оценки параметров привязки в~соответствии с~выражением
\[
\hat{\bar{\alpha}}_{t+1}=\hat{\bar{\alpha}}_{t}-\Lambda_{t}\bar{\beta}_{t}
\]
где: $\bar{\alpha}$ -- \textit{m}-мерный вектор оцениваемых параметров, $t=\overline{0,T}$ -- номер итерации, $\Lambda_{t}$ -- матрица усиления (всегда положительно определенная матрица, как правило диагональная, что исключает собственно матричные вычисления), $\bar{\beta}_{t}$ -- псевдоградиент целевой функции $J(\bar{\alpha})$ (случайный вектор, зависящий в~общем случае от~$\bar{\alpha}_{t-1}$ и~целевой функции $J(\bar{\alpha})$).

Для нестационарных сигналов значения элементов $\lambda_{t}$, $t=\overline{1,T}$, приходится ограничивать снизу для обеспечения вариабельности оценок. Хорошие результаты сходимости оценок можно получить уже при использовании знаковой функции от~значения псевдоградиента на~каждой итерации:
\[
\hat{\bar{\alpha}}_{t+1}=\hat{\bar{\alpha}}_{t}-\Lambda_{t}\text{sign}(\bar{\beta}_{t}),
\]
где
\[
\text{sign}(\beta_{it})= 
\left\{
	\begin{aligned}
		1, &\text{ если } \beta_{it} > 0, \\
		0, &\text{ если } \beta_{it} = 0, \\
		-1, &\text{ если } \beta_{it} < 0, \\
	\end{aligned}
\right.
\]
что значительно упрощает практическую реализацию. Псевдоградиент $\bar{\beta}_{t}$ на~каждой итерации псевдоградиентой процедуры вычисляется не по~всем исследуемым отсчетам сигнала, а по~некоторому их усечению – так называемой локальной выборке
\[
Z_t = \left\{z^{(2)}_{jt}, \tilde{z}^{(1)}_{jt}\right\}; z^{(2)}_{jt} \in \mathbf{Z}^{(2)}, \tilde{z}^{(1)}_{jt} = \tilde{z}^{(1)}\left(\bar{j_t}, \hat{\bar{\alpha}}_{t-1} \in \tilde{Z}\right),
\]
где $z^{(2)}_{jt}$ -- отсчеты уровня сигнала $\mathbf{Z}^{(2)}$, взятые в~локальную выборку на~\textit{t}-й итерации (сигнал $\mathbf{Z}^{(2)}$ условно будем считать привязываемым), а~$\tilde{z}^{(1)}_{jt}~=~\tilde{z}^{(1)}\left(\bar{j_t}, \hat{\bar{\alpha}}_{t-1}\right)$ -- значения уровня сигнала, взятые из~непрерывного сигнала $\tilde{Z}^{(1)}$, полученного из~опорного сигнала $\mathbf{Z}^{(1)}$ с~помощью некоторой интерполяции и~текущих значений параметров деформации; $j_t$ -- координаты отсчетов $\tilde{z}^{(2)}_{jt}$.
Число $\mu$ отсчетов  $\left\{z^{(2)}_{jt}\right\}$ в~$Z_t$ является объемом локальной выборки. Он, как правило, небольшой и~составляет от~единиц до десятков. 

При псевдоградиентном оценивании параметров привязки импульсов в~качестве целевых функций качества целесообразно использовать средний квадрат разности интенсивностей отсчетов совмещаемых импульсов (СКР) или коэффициент их корреляции (КК) \cite{Tsypkin_1995}.

В начале выполнения очередной итерации происходит обнуление числа отсчетов локальной выборки $Z_t$  (мощности выборки) и~вектора псевдоградиента $\bar{\beta}$. Для обеспечения заданного объема $\mu$ локальной выборки проверяется условие достижения $\mu$ текущим числом отсчетов $Z_t$. Если текущее число отсчетов меньше заданного объема, производится выбор координаты очередного отсчета $j$. Для вычисления псевдоградиента к~этой координате применяются текущие параметры привязки $\bar{\alpha}_{t-1}$ и~вычисляются новая координата $j'$. При достижении заданного числа отсчетов $\mu$ выполняется вычисление псевдоградиента, обновление параметров привязки и~приращение числа итераций.

Псевдоградиентные процедуры рекуррентны, сочетают хорошие точностные возможности с~высоким быстродействием, не требуют предварительной оценки параметров исследуемых изображений, применимы в~условиях плавно меняющейся неоднородности. Однако, поскольку рассогласование оцениваемых параметров $\alpha$ и~их начальных приближений $\hat{\alpha}_0$ априорно неизвестно, а сходимость оценок к~оптимальным значениям представляет собой случайный процесс, число итераций  $T$ выбирается из~условия обеспечения требуемой точности оценивания в~наихудших условиях.

При таком минимаксном подходе число итераций не зависит от~рассогласования и~при более благоприятных условиях является избыточным. Поэтому целесообразно использование критериев остановки процесса оценивания при достижении оценками области оптимальных значений (достижении стабилизации процесса оценивания). Сами оптимальные значения, конечно, априорно не известны, однако достижение оценками их окрестности можно косвенно определить, рассматривая последовательность оценок как случайный процесс и~анализируя изменение вероятностных параметров оценок в~процессе сходимости. Несколько критериев остановки предложено в~работе  \cite{Vasilyev_2007}. Предложенные критерии основаны на~том, что характер поведения оценок параметров при достижении окрестности оптимального значения существенно меняется. Это хорошо видно из~рис.~\ref{img:dyn_mean}, на~котором для примера приведена зависимость (линия 1) от~числа итераций одного из~оцениваемых параметров (компоненты $h$ сдвига исследуемого импульса относительно опорного) при небольших шумах.
\begin{figure}[h]
	\center{\includegraphics{dyn_mean}}
	\caption{Пример динамики оценки сдвига}
	\label{img:dyn_mean}
\end{figure}

После достижения оптимального значения (примерно 3700 итерация) оценка стабилизируется и~имеет лишь небольшие случайные отклонения. Последующие итерации практически не дают повышения точности. На том же рисунке (и последующих рисунках) линией 2 показано среднее значение параметра евклидова расстояния рассогласования $E_t$, вычисленное в~скользящем окне размером $w~=~250$:
\[
	m_{E_t}=\frac{1}{w}\sum_{k=a}^{b}E_t,
\]
где $a=t-\left[\dfrac{(w-1)}{2}\right], b=t+\left[{w}{2}\right]; [(\cdot)] - \text{целая часть}$.

Для остановки процесса оценивания предлагается проверять гипотезу о его стабилизации. Гипотеза проверяется параллельно с~работой процедур, не прерывая их. В результате проверки возможны ошибка первого рода -- стабилизация процесса оценивания параметров произошла, а критерий проверки гипотезы показал ее отсутствие, и~ошибка второго рода -- критерий показал стабилизацию при ее фактическом отсутствии. Вероятность ошибки второго рода можно выбрать исходя из~максимально допустимого числа срывов оценивания.

При нахождении расчетного значения критерия проверки гипотезы вместо оценок совокупности параметров $\alpha$ целесообразно использовать их интегральную характеристику -- евклидово расстояние \cite{Tashlinsky_2013} $E_t$: рассогласования (между положением точки сигнала при деформациях с~параметрами $\alpha$ и~положением этой точки при деформациях с~параметрами $\hat{\alpha_t}$). Пример зависимости $E$ от~числа итераций для отдельной не зашумлённой реализации приведен на~рис.~\ref{img:example_changes_E_M},а (линия 1). Видно, что до достижения оценками параметров окрестностей оптимальных значений (примерно до 1200 итерации) $E$ уменьшается, при дальнейшем росте числа итераций   существенно не меняется, колеблясь около нулевого значения.

\begin{figure}[h]
	\begin{minipage}[h]{0.49\linewidth}
		\center{\includegraphics[width=\linewidth]{example_changes_a} \\ \small{а)}}
	\end{minipage}
	\hfill
	\begin{minipage}[h]{0.49\linewidth}
		\center{\includegraphics[width=\linewidth]{example_changes_b} \\ \small{б)}}
	\end{minipage}
	\caption{Пример изменения $E$ и~$M$ до и~после стабилизации}
	\label{img:example_changes_E_M}
\end{figure}

Стабилизация оценок, формируемых псевдоградиентной процедурой (рис.~\ref{img:char_mean},а), при достижении оптимальных значений параметров привязки сигналов может быть использована и~для решения задачи обнаружения сигналов. При совмещении двух слабо коррелированных сигналов зависимость оценок параметров от~номера итерации в~общем случае колеблется вокруг нулевого значения с~относительно большим значением дисперсии оценок (рис.~\ref{img:char_mean},б), при этом оценки параметров не сходятся к~какому-то конкретному значению. Такая ситуация характерна для случая отсутствия «полезного» радиосигнала от~источника излучения на~входе элементов ФАР.

\begin{figure}[h]
	\begin{minipage}{\linewidth}
		\center{\includegraphics[width=\textwidth]{strong_corr} \\ \small{а)}}
	\end{minipage}
	\vfill
	\begin{minipage}{\linewidth}
		\center{\includegraphics[width=\textwidth]{weak_corr} \\ \small{б)}}
	\end{minipage}
	\caption{Характер сходимости оценки к~оптимальному значению при сильно коррелированных (а) и~слабо коррелированных сигналах (б)}
	\label{img:char_mean}
\end{figure}

Рассмотрим несколько подходов к~решению задачи обнаружения импульсов по~исходному нефильтрованному сигналу. Пусть на~выходах первого и~второго приемников фазированной антеной решетки (ФАР), разнесенных в~пространстве, наблюдаются сигналы $\mathbf{Z}^{(1)}(n)$ и~$\mathbf{Z}^{(2)}(n)$ соответственно, где $n$ - это номер отсчета (дискретное время). Требуется обнаружить в~исходных сигналах радиоимпульсы, параметры которых априорно неизвестны. Используем для этого анализ сходимости оценок привязки искомых импульсов.

Рассмотрим алгоритм обнаружения при использовании в~качестве критерия сходимости оценок псевдоградиентной процедуры значения угла наклона тренда $\gamma_i$:
\[
	\gamma_i=\frac{w\sum\limits_{k=a}^{b}kE_k-\sum\limits_{k=a}^{b}E_k\sum\limits_{k=a}^{b}k}{w\sum\limits_{k=a}^{b}k^2-\left(\sum\limits_{k=a}^{b}k\right)^2}
\]

При этом в~качестве целевой функции удобнее применить КК, так как оценивается лишь один параметр, а именно временной сдвиг $h$.

Параметры привязки импульсов оцениваются с~помощью псевдоградиентной процедуры в~скользящем окне величиной $w_t$. Величина окна соответствует заданному объему локальной выборки, т.е. на~каждой итерации используются все отсчеты, попавшие в~окно. После каждой итерации окно сдвигается на~один отсчет. Параллельно с~заданным окном $w_d$ вычисляется величина угла наклона тренда оценки параметра сдвига $\hat{h}_t$, где $t$ - номер итерации. Одновременно с~этим, в~окне проверяется критерий обнаружения: заданный процент значений угла наклона тренда в~окне $Tr_2$ не должен превышать определенный порог $Tr_1$. Для усиления данного критерия можно также использовать ограничение по~максимальному отклонению значений угла наклона тренда в~окне. Пример работы алгоритма приведен на~рис.~\ref{img:det_sig_1}, где на~рис~\ref{img:det_sig_1},а,б приведены исходные сигналы $\mathbf{Z}^{(1)}(n)$ и~$\mathbf{Z}^{(2)}(n)$, полученные экспериментально с~двух выходов антенной решетки в~безэховой камере (частота дискретизации $f_{\textit{д}}=1,25\textit{ ГГц}$), рис.~\ref{img:det_sig_1},в – оценка сдвига $\hat{h}_t$ возможных полезных сигналов, полученных псевдоградиентной процедурой с~последовательной обработкой отсчетов. Параметры процедуры: объем выборки $\mu=15$, шаг оценки сдвига $\lambda_h=0,01$, приращение оценки сдвига $\Delta_h=1$. На рис.~\ref{img:det_sig_1},г – показан угол наклона тренда $\gamma_i$ при \textit{i}-м положении окна шириной $w_t=200$. Там же проиллюстрированы условия обнаружение импульса при использовании порогового значения (прямые горизонтальные линии) для угла наклона тренда $Tr_1=5\cdot10^{-4}$ (в радианах) и~предельного процента превышения $Tr_2=80$. 

На рис.~\ref{img:det_sig_1},д приведен результат проверки гипотезы об обнаружении $P_n$ (1~--~если гипотеза верна и~0 в~обратной ситуации). Наблюдается уверенное обнаружение сигнала. 

\begin{figure}[ph]
	\begin{minipage}{\linewidth}
		\center{\includegraphics[width=0.8\textwidth]{det_sig_11} \\ {\small а)}}
	\end{minipage}
	\begin{minipage}{\linewidth}
		\center{\includegraphics[width=0.8\textwidth]{det_sig_12} \\ {\small б)}}
	\end{minipage}
	\begin{minipage}{\linewidth}
		\center{\includegraphics[width=0.8\textwidth]{det_sig_13} \\ {\small в)}}
	\end{minipage}
	\begin{minipage}{\linewidth}
		\center{\includegraphics[width=0.8\textwidth]{det_sig_14} \\ {\small г)}}
	\end{minipage}
	\begin{minipage}{\linewidth}
		\center{\includegraphics[width=0.8\textwidth]{det_sig_15} \\ {\small д)}}
	\end{minipage}
	\caption{Обнаружение сигнала по~характеру сходимости оценок псевдоградиентной  процедуры (относительно короткие импульсы)}
	\label{img:det_sig_1}
\end{figure}

Приведем также результаты экспериментов при относительно небольшой (по сравнению с~инерционностью процедуры оценивания) длительность искомых сигналов. На рис.~\ref{img:det_sig_2} представлен пример обнаружения при длительности импульсов порядка 250 отсчетов. 

\begin{figure}[ph]
	\begin{minipage}{\linewidth}
		\center{\includegraphics[width=0.8\textwidth]{det_sig_21} \\ {\small а) Сигнал, наблюдаемый на~выходе первого приемника}}
	\end{minipage}
	\begin{minipage}{\linewidth}
		\center{\includegraphics[width=0.8\textwidth]{det_sig_22} \\ {\small б) Сигнал, наблюдаемый на~выходе второго приемника}}
	\end{minipage}
	\begin{minipage}{\linewidth}
		\center{\includegraphics[width=0.8\textwidth]{det_sig_23} \\ {\small в) Оценка сдвига импульсов}}
	\end{minipage}
	\begin{minipage}{\linewidth}
		\center{\includegraphics[width=0.8\textwidth]{det_sig_24} \\ {\small г) Величина и~порог угла наклона тренда}}
	\end{minipage}
	\begin{minipage}{\linewidth}
		\center{\includegraphics[width=0.8\textwidth]{det_sig_25} \\ {\small д) Обнаруженное местоположение импульса}}
	\end{minipage}
	\caption{Обнаружение сигнала по~характеру сходимости оценок псевдоградиентной  процедуры (относительно короткие импульсы)}
	\label{img:det_sig_2}
\end{figure}

Использованы также реальные данные, полученные в~ходе летного эксперимента. Здесь $\mathbf{Z}^{(1)}(n)$ и~$\mathbf{Z}^{(2)}(n)$ на~рис.~\ref{img:det_sig_2},а,б – исходные исследуемые цифровые последовательности отсчетов в~с двух выходов приемников антенной решетки, $f_{\textit{д}}=250\textit{ МГц}$). На рис.~\ref{img:det_sig_2},в приведена оценка сдвига $\hat{h}_t$ импульсов, сформированного псевдоградиентной процедурой, а на~рис.~\ref{img:det_sig_2},г – угол наклона тренда $\gamma_i$ при ширине окна   и~порог обнаружения импульса $Tr_1=5\cdot10^{-4}$ (прямые горизонтальные линии). Заданный порог предельного процента превышения $Tr_2=60$. На рис.~\ref{img:det_sig_2},д приведен результат проверки гипотезы об обнаружении импульса.

Заметим, что размеры окна $w_t$ в~этом эксперименте уменьшены, поскольку область сходимости оценки параметра сдвига относительно небольшая. Если же мы используем те же параметры, что и~для «широких» импульсов ($w_t=200, Tr_1=5\cdot10^{-4}, Tr_2=80$), то импульс при исследуемом подходе не обнаруживается (рис.~\ref{img:no_det_sig}, где на~рис.~\ref{img:no_det_sig},а показан сигнал, наблюдаемый на~выходе второго приемника, на~рис.~\ref{img:no_det_sig},б - величина и~порог угла наклона тренда, а на~рис.~\ref{img:no_det_sig},в - обнаруженное местоположение импульса, точнее, отсутствие такового).

Конечно, предложенный подход не обеспечивает нулевой вероятности ошибки второго рода и~при неудачном выборе параметров алгоритмов или малом отношении сигнал/шум может давать ложное обнаружение импульсов.

Пример такой ситуации приведен на~рис.~\ref{img:det_false}. Здесь пороговое значение $Tr_1$ было увеличено до $7\cdot10^{-4}$. На рис.~\ref{img:det_false},а показаны порог угла наклона тренда, а на~рис.~\ref{img:det_false},б - обнаруженные местоположения импульсов. Видно, что два из~них являются ложными.

\begin{figure}[h]
	\begin{minipage}{\linewidth}
			\center{\includegraphics[width=0.8\textwidth]{no_det_sig_1} \\ {\small а) Сигнал, наблюдаемый на~выходе второго приемника}}
		\end{minipage}
		\begin{minipage}{\linewidth}
			\center{\includegraphics[width=0.8\textwidth]{no_det_sig_2} \\ {\small б) Величина и~порог угла наклона тренда}}
		\end{minipage}
		\begin{minipage}{\linewidth}
			\center{\includegraphics[width=0.8\textwidth]{no_det_sig_3} \\ {\small в) Обнаруженное местоположение импульсов}}
		\end{minipage}
	\caption{Пример не обнаружения сигнала по~характеру сходимости оценок}
	\label{img:no_det_sig}
\end{figure}

\begin{figure}[h]
	\begin{minipage}{\linewidth}
		\center{\includegraphics[width=0.8\textwidth]{det_false_1} \\ {\small а) Величина и~порог угла наклона тренда}}
	\end{minipage}
	\begin{minipage}{\linewidth}
		\center{\includegraphics[width=0.8\textwidth]{det_false_2} \\ {\small б) Обнаруженное местоположение импульсов}}
	\end{minipage}
	\caption{Пример ложного обнаружения сигнала по~характеру сходимости оценок}
	\label{img:det_false}
\end{figure}

Таким образом, предложенный и~исследованных подход к~обнаружению радиоимпульсов с~одновременным измерением их взаимного сдвига (разностно-временная обработка) по~характеру сходимости оценок псевдоградиентной процедуры показал свою работоспособность и~высокую вероятность правильного обнаружения местоположения импульсов.

К недостаткам исследованного подхода можно отнести необходимость подбора нескольких параметров алгоритма (шаг приращения оцениваемых параметров, ширина скользящего окна, порог угла наклона тренда и~процент не превышающих порог в~окне значений тренда), а также высокую вероятность ложного обнаружения при относительно «коротких» импульсах (когда длительность обнаруживаемых импульсов сравнима с~инерционность псевдоградиентной процедуры.

Однако, как показали исследования, псевдоградиентная процедура в~процессе своей работы, т.е. в~режиме реального времени, позволяет использовать и~другие критерии обнаружения сигнала и~его местоположения.



